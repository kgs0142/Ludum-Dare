this is a revise version of DAME's sample.